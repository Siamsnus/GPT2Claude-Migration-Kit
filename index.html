<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GPT→Claude Migration Kit — Export everything from ChatGPT</title>
<meta name="description" content="Export your ChatGPT memories, conversations, and instructions. No install needed. One click, everything downloads.">
<meta property="og:title" content="GPT→Claude Migration Kit">
<meta property="og:description" content="Export everything from ChatGPT. No extensions, no install. One click.">
<meta property="og:type" content="website">
<link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=DM+Sans:ital,wght@0,400;0,500;0,600;0,700;1,400&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #08080a;
    --surface: #111114;
    --surface2: #18181c;
    --border: #252530;
    --text: #e4e4ea;
    --text-dim: #7a7a88;
    --accent: #d4a574;
    --accent-glow: rgba(212, 165, 116, 0.15);
    --gpt: #9898d4;
    --green: #7eb8a0;
    --red: #d47474;
    --mono: 'Space Mono', monospace;
    --sans: 'DM Sans', system-ui, sans-serif;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  html { scroll-behavior: smooth; }
  body { background: var(--bg); color: var(--text); font-family: var(--sans); line-height: 1.7; min-height: 100vh; overflow-x: hidden; }

  /* Grain overlay */
  body::before {
    content: "";
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.03'/%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 1;
  }

  .container { max-width: 720px; margin: 0 auto; padding: 0 2rem; position: relative; z-index: 2; }

  /* ========== HERO ========== */
  .hero {
    padding: 6rem 0 4rem;
    text-align: center;
  }
  .hero-badge {
    display: inline-block;
    padding: 4px 14px;
    border: 1px solid var(--border);
    border-radius: 100px;
    font-family: var(--mono);
    font-size: 0.72rem;
    color: var(--text-dim);
    margin-bottom: 2rem;
    letter-spacing: 0.05em;
  }
  .hero h1 {
    font-size: clamp(2.2rem, 5vw, 3.2rem);
    font-weight: 700;
    letter-spacing: -0.03em;
    line-height: 1.15;
    margin-bottom: 1.5rem;
  }
  .hero h1 .gpt { color: var(--gpt); }
  .hero h1 .arrow { color: var(--text-dim); opacity: 0.4; }
  .hero h1 .claude { color: var(--accent); }
  .hero p {
    font-size: 1.1rem;
    color: var(--text-dim);
    max-width: 520px;
    margin: 0 auto 3rem;
  }

  /* ========== BOOKMARKLET SECTION ========== */
  .bookmark-section {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 3rem 2.5rem;
    text-align: center;
    position: relative;
    overflow: hidden;
  }
  .bookmark-section::before {
    content: "";
    position: absolute;
    top: -1px; left: -1px; right: -1px;
    height: 3px;
    background: linear-gradient(90deg, var(--gpt), var(--accent));
    border-radius: 20px 20px 0 0;
  }
  .bookmark-section h2 {
    font-size: 1.3rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
  }
  .bookmark-section .subtitle {
    color: var(--text-dim);
    font-size: 0.92rem;
    margin-bottom: 2rem;
  }

  .bookmarklet-link {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    padding: 16px 32px;
    background: linear-gradient(135deg, #d4a574, #c49060);
    color: #0a0a0b;
    font-family: var(--sans);
    font-size: 1rem;
    font-weight: 700;
    text-decoration: none;
    border-radius: 12px;
    cursor: grab;
    transition: all 0.2s ease;
    box-shadow: 0 4px 20px var(--accent-glow), 0 0 0 1px rgba(212, 165, 116, 0.3);
    user-select: none;
    -webkit-user-select: none;
  }
  .bookmarklet-link:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 30px var(--accent-glow), 0 0 0 1px rgba(212, 165, 116, 0.5);
  }
  .bookmarklet-link:active {
    cursor: grabbing;
    transform: scale(0.98);
  }

  .drag-hint {
    margin-top: 1.25rem;
    font-size: 0.82rem;
    color: var(--text-dim);
  }
  .drag-hint strong { color: var(--text); }

  .drag-arrow {
    display: block;
    margin: 1.5rem auto 0;
    color: var(--accent);
    opacity: 0.5;
    font-size: 2rem;
    animation: bounce 2s ease-in-out infinite;
  }
  @keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-8px); }
  }

  /* ========== STEPS ========== */
  .steps {
    padding: 4rem 0;
  }
  .steps h2 {
    font-size: 1.3rem;
    font-weight: 700;
    margin-bottom: 2rem;
    text-align: center;
  }
  .step-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }
  .step-item {
    display: flex;
    gap: 1.25rem;
    align-items: flex-start;
    padding: 1.5rem;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 14px;
    transition: border-color 0.2s;
  }
  .step-item:hover { border-color: #353540; }
  .step-num {
    flex-shrink: 0;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 10px;
    font-family: var(--mono);
    font-size: 0.85rem;
    font-weight: 700;
  }
  .step-num.s1 { background: rgba(152, 152, 212, 0.12); color: var(--gpt); }
  .step-num.s2 { background: var(--accent-glow); color: var(--accent); }
  .step-num.s3 { background: rgba(126, 184, 160, 0.12); color: var(--green); }
  .step-text h3 { font-size: 0.95rem; font-weight: 600; margin-bottom: 0.25rem; }
  .step-text p { font-size: 0.88rem; color: var(--text-dim); }

  /* ========== WHAT YOU GET ========== */
  .exports-section {
    padding: 0 0 4rem;
  }
  .exports-section h2 {
    font-size: 1.3rem;
    font-weight: 700;
    margin-bottom: 2rem;
    text-align: center;
  }
  .export-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
  }
  .export-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 1.5rem;
    text-align: center;
  }
  .export-card .icon { font-size: 2rem; margin-bottom: 0.75rem; }
  .export-card h3 { font-size: 0.9rem; font-weight: 600; margin-bottom: 0.25rem; }
  .export-card p { font-size: 0.8rem; color: var(--text-dim); }
  .export-card .filename {
    display: inline-block;
    margin-top: 0.75rem;
    font-family: var(--mono);
    font-size: 0.7rem;
    padding: 3px 10px;
    background: var(--surface2);
    border-radius: 4px;
    color: var(--accent);
  }

  /* ========== CONSOLE FALLBACK ========== */
  .fallback {
    padding: 0 0 4rem;
  }
  .fallback-box {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 2rem;
  }
  .fallback-box h3 { font-size: 1rem; font-weight: 600; margin-bottom: 0.5rem; }
  .fallback-box p { font-size: 0.88rem; color: var(--text-dim); margin-bottom: 1rem; }
  .fallback-box code {
    display: block;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 12px 16px;
    font-family: var(--mono);
    font-size: 0.75rem;
    color: var(--accent);
    overflow-x: auto;
    word-break: break-all;
    line-height: 1.6;
    cursor: pointer;
    transition: border-color 0.2s;
    position: relative;
  }
  .fallback-box code:hover { border-color: var(--accent); }
  .fallback-box code::after {
    content: "click to copy";
    position: absolute;
    top: 8px;
    right: 12px;
    font-size: 0.65rem;
    color: var(--text-dim);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }
  .fallback-box code.copied::after { content: "copied!"; color: var(--green); }

  /* ========== FAQ ========== */
  .faq {
    padding: 0 0 4rem;
  }
  .faq h2 {
    font-size: 1.3rem;
    font-weight: 700;
    margin-bottom: 2rem;
    text-align: center;
  }
  .faq-item {
    padding: 1.25rem 0;
    border-bottom: 1px solid var(--border);
  }
  .faq-item:first-child { border-top: 1px solid var(--border); }
  .faq-item h3 { font-size: 0.92rem; font-weight: 600; margin-bottom: 0.4rem; }
  .faq-item p { font-size: 0.88rem; color: var(--text-dim); }

  /* ========== FOOTER ========== */
  .footer {
    padding: 3rem 0;
    border-top: 1px solid var(--border);
    text-align: center;
    font-size: 0.8rem;
    color: var(--text-dim);
  }
  .footer a { color: var(--accent); text-decoration: none; }
  .footer a:hover { text-decoration: underline; }
  .footer p { margin-bottom: 0.4rem; }

  /* ========== MOBILE ========== */
  @media (max-width: 640px) {
    .hero { padding: 4rem 0 3rem; }
    .bookmark-section { padding: 2rem 1.5rem; }
    .export-grid { grid-template-columns: 1fr; }
    .container { padding: 0 1.25rem; }
  }
</style>
</head>
<body>

<div class="container">

  <!-- HERO -->
  <div class="hero">
    <div class="hero-badge">v2.0 &mdash; OPEN SOURCE &mdash; MIT LICENSE</div>
    <h1>
      Move from <span class="gpt">ChatGPT</span>
      <span class="arrow">&rarr;</span>
      <span class="claude">Claude</span>
    </h1>
    <p>Export your memories, every conversation, and all custom instructions. No extensions to install. No data leaves your browser. One click.</p>
  </div>

  <!-- BOOKMARKLET -->
  <div class="bookmark-section" id="install">
    <h2>Install in 3 seconds</h2>
    <p class="subtitle">Drag this button to your bookmark bar. That's it.</p>

    <a class="bookmarklet-link" id="bookmarklet-btn" href="#"
       onclick="event.preventDefault();alert('Don\u0027t click — drag this button up to your bookmark bar!');">
      &#x1F4E6;&ensp;GPT&rarr;Claude Export
    </a>

    <p class="drag-hint">
      <strong>Drag</strong> the button above into your bookmark bar.<br>
      Don't see your bookmark bar? Press <strong>Ctrl+Shift+B</strong> (Windows) or <strong>Cmd+Shift+B</strong> (Mac).
    </p>
    <span class="drag-arrow">&uarr;</span>

    <p class="drag-hint" style="margin-top:1rem; font-size:0.78rem; color:#555;">
      If dragging doesn't work, right-click the button &rarr; <strong>Bookmark This Link</strong>
    </p>
  </div>

  <script id="migrate-script">
// GPT2Claude Migration Kit v2.0
// https://github.com/Siamsnus/GPT2Claude-Migration-Kit
// Exports ChatGPT memories, conversations, and instructions
// No data leaves your browser - everything runs locally

(function() {
  // Prevent double-loading
  if (document.getElementById("gpt2claude-panel")) {
    var existing = document.getElementById("gpt2claude-panel");
    existing.style.animation = "g2c-shake 0.3s ease-in-out";
    setTimeout(function() { existing.style.animation = ""; }, 300);
    return;
  }

  // ========== STYLES ==========
  var style = document.createElement("style");
  style.textContent = "\
    @keyframes g2c-fadein { from { opacity: 0; transform: translateY(20px) scale(0.95); } to { opacity: 1; transform: translateY(0) scale(1); } }\
    @keyframes g2c-shake { 0%,100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }\
    @keyframes g2c-spin { to { transform: rotate(360deg); } }\
    @keyframes g2c-pulse { 0%,100% { opacity: 1; } 50% { opacity: 0.5; } }\
    #gpt2claude-panel { position: fixed; top: 50%; right: 24px; transform: translateY(-50%); width: 340px; background: #0a0a0b; border: 1px solid #2a2a30; border-radius: 16px; box-shadow: 0 25px 60px rgba(0,0,0,0.6), 0 0 0 1px rgba(255,255,255,0.05); z-index: 999999; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; color: #e8e8ec; animation: g2c-fadein 0.3s ease-out; }\
    #gpt2claude-panel * { box-sizing: border-box; margin: 0; padding: 0; }\
    .g2c-header { display: flex; justify-content: space-between; align-items: center; padding: 16px 20px 12px; border-bottom: 1px solid #2a2a30; }\
    .g2c-title { font-size: 14px; font-weight: 700; letter-spacing: -0.01em; }\
    .g2c-title span.gpt { color: #a0a0e0; }\
    .g2c-title span.arrow { color: #555; margin: 0 4px; }\
    .g2c-title span.claude { color: #d4a574; }\
    .g2c-version { font-size: 10px; color: #555; font-weight: 600; }\
    .g2c-close { background: none; border: none; color: #666; font-size: 18px; cursor: pointer; padding: 4px 8px; border-radius: 6px; line-height: 1; }\
    .g2c-close:hover { background: #1c1c20; color: #e8e8ec; }\
    .g2c-body { padding: 16px 20px; }\
    .g2c-btn { width: 100%; padding: 12px 16px; border: 1px solid #2a2a30; border-radius: 10px; background: #141416; color: #e8e8ec; font-size: 13px; font-weight: 600; cursor: pointer; text-align: left; margin-bottom: 8px; display: flex; align-items: center; gap: 10px; transition: all 0.15s ease; position: relative; overflow: hidden; }\
    .g2c-btn:hover { background: #1c1c20; border-color: #3a3a40; transform: translateY(-1px); }\
    .g2c-btn:active { transform: translateY(0); }\
    .g2c-btn.running { pointer-events: none; border-color: #d4a574; }\
    .g2c-btn.done { border-color: #7eb8a0; }\
    .g2c-btn.error { border-color: #e07070; }\
    .g2c-btn-icon { font-size: 18px; width: 24px; text-align: center; flex-shrink: 0; }\
    .g2c-btn-text { flex: 1; }\
    .g2c-btn-sub { font-size: 11px; color: #666; font-weight: 400; margin-top: 2px; }\
    .g2c-progress { margin-top: 6px; }\
    .g2c-progress-bar { width: 100%; height: 4px; background: #1c1c20; border-radius: 2px; overflow: hidden; }\
    .g2c-progress-fill { height: 100%; background: linear-gradient(90deg, #d4a574, #e8c49a); border-radius: 2px; transition: width 0.3s ease; width: 0%; }\
    .g2c-progress-text { font-size: 11px; color: #8e8e96; margin-top: 4px; }\
    .g2c-log { margin-top: 12px; max-height: 120px; overflow-y: auto; background: #0d0d0e; border: 1px solid #1c1c20; border-radius: 8px; padding: 8px 10px; font-family: 'SF Mono', 'Consolas', monospace; font-size: 11px; line-height: 1.5; color: #8e8e96; display: none; }\
    .g2c-log.visible { display: block; }\
    .g2c-log-entry { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }\
    .g2c-log-entry.error { color: #e07070; }\
    .g2c-log-entry.success { color: #7eb8a0; }\
    .g2c-footer { padding: 12px 20px; border-top: 1px solid #1c1c20; display: flex; justify-content: space-between; align-items: center; }\
    .g2c-footer-text { font-size: 10px; color: #444; }\
    .g2c-footer-link { font-size: 10px; color: #d4a574; text-decoration: none; }\
    .g2c-footer-link:hover { text-decoration: underline; }\
    .g2c-spinner { display: inline-block; width: 14px; height: 14px; border: 2px solid #333; border-top-color: #d4a574; border-radius: 50%; animation: g2c-spin 0.6s linear infinite; }\
    .g2c-toggle-log { background: none; border: none; color: #555; font-size: 11px; cursor: pointer; padding: 4px 0; margin-top: 8px; }\
    .g2c-toggle-log:hover { color: #999; }\
    .g2c-drag-handle { cursor: move; }\
  ";
  document.head.appendChild(style);

  // ========== PANEL HTML ==========
  var panel = document.createElement("div");
  panel.id = "gpt2claude-panel";
  panel.innerHTML = '\
    <div class="g2c-header g2c-drag-handle">\
      <div>\
        <div class="g2c-title"><span class="gpt">GPT</span><span class="arrow">\u2192</span><span class="claude">Claude</span></div>\
        <div class="g2c-version">Migration Kit v2.0</div>\
      </div>\
      <button class="g2c-close" id="g2c-close">\u00D7</button>\
    </div>\
    <div class="g2c-body">\
      <button class="g2c-btn" id="g2c-btn-memory">\
        <div class="g2c-btn-icon">\uD83E\uDDE0</div>\
        <div class="g2c-btn-text">\
          Export Memories\
          <div class="g2c-btn-sub">Facts ChatGPT learned about you</div>\
        </div>\
      </button>\
      <button class="g2c-btn" id="g2c-btn-convos">\
        <div class="g2c-btn-icon">\uD83D\uDCAC</div>\
        <div class="g2c-btn-text">\
          Export All Conversations\
          <div class="g2c-btn-sub">Every chat with full history</div>\
        </div>\
      </button>\
      <button class="g2c-btn" id="g2c-btn-instructions">\
        <div class="g2c-btn-icon">\u2699\uFE0F</div>\
        <div class="g2c-btn-text">\
          Export Instructions\
          <div class="g2c-btn-sub">Custom instructions &amp; settings</div>\
        </div>\
      </button>\
      <div class="g2c-progress" id="g2c-progress" style="display:none;">\
        <div class="g2c-progress-bar"><div class="g2c-progress-fill" id="g2c-progress-fill"></div></div>\
        <div class="g2c-progress-text" id="g2c-progress-text"></div>\
      </div>\
      <button class="g2c-toggle-log" id="g2c-toggle-log">Show log \u25BC</button>\
      <div class="g2c-log" id="g2c-log"></div>\
    </div>\
    <div class="g2c-footer">\
      <span class="g2c-footer-text">All data stays in your browser</span>\
      <a class="g2c-footer-link" href="https://github.com/Siamsnus/GPT2Claude-Migration-Kit" target="_blank">GitHub</a>\
    </div>\
  ';
  document.body.appendChild(panel);

  // ========== DRAGGING ==========
  var isDragging = false;
  var dragOffsetX = 0;
  var dragOffsetY = 0;
  var header = panel.querySelector(".g2c-drag-handle");

  header.addEventListener("mousedown", function(e) {
    if (e.target.classList.contains("g2c-close")) return;
    isDragging = true;
    var rect = panel.getBoundingClientRect();
    dragOffsetX = e.clientX - rect.left;
    dragOffsetY = e.clientY - rect.top;
    panel.style.transition = "none";
    e.preventDefault();
  });

  document.addEventListener("mousemove", function(e) {
    if (!isDragging) return;
    panel.style.right = "auto";
    panel.style.transform = "none";
    panel.style.left = (e.clientX - dragOffsetX) + "px";
    panel.style.top = (e.clientY - dragOffsetY) + "px";
  });

  document.addEventListener("mouseup", function() {
    isDragging = false;
    panel.style.transition = "";
  });

  // ========== HELPERS ==========
  var logEl = document.getElementById("g2c-log");
  var progressEl = document.getElementById("g2c-progress");
  var progressFill = document.getElementById("g2c-progress-fill");
  var progressText = document.getElementById("g2c-progress-text");

  function log(msg, type) {
    var entry = document.createElement("div");
    entry.className = "g2c-log-entry" + (type ? " " + type : "");
    entry.textContent = msg;
    logEl.appendChild(entry);
    logEl.scrollTop = logEl.scrollHeight;
  }

  function setProgress(pct, text) {
    progressEl.style.display = "block";
    progressFill.style.width = pct + "%";
    if (text) progressText.textContent = text;
  }

  function setButtonState(btn, state, label) {
    btn.className = "g2c-btn " + state;
    var iconEl = btn.querySelector(".g2c-btn-icon");
    if (state === "running") {
      iconEl.innerHTML = '<div class="g2c-spinner"></div>';
    } else if (state === "done") {
      iconEl.textContent = "\u2705";
    } else if (state === "error") {
      iconEl.textContent = "\u274C";
    }
    if (label) {
      btn.querySelector(".g2c-btn-sub").textContent = label;
    }
  }

  function downloadFile(content, filename, type) {
    var blob = new Blob([content], {type: type || "text/plain"});
    var url = URL.createObjectURL(blob);
    var a = document.createElement("a");
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
    log("Downloaded: " + filename, "success");
  }

  var cachedToken = null;

  async function getToken() {
    if (cachedToken) return cachedToken;
    log("Authenticating...");
    var resp = await fetch("https://chatgpt.com/api/auth/session", {credentials: "include"});
    if (resp.status !== 200) {
      throw new Error("Auth failed (HTTP " + resp.status + "). Are you logged in?");
    }
    var data = await resp.json();
    if (!data.accessToken) {
      throw new Error("No token found. Please refresh chatgpt.com and try again.");
    }
    cachedToken = data.accessToken;
    log("Authenticated OK");
    return cachedToken;
  }

  // ========== EXPORT: MEMORIES ==========
  async function exportMemories() {
    var btn = document.getElementById("g2c-btn-memory");
    setButtonState(btn, "running", "Exporting...");

    try {
      var token = await getToken();

      log("Fetching memories...");
      var resp = await fetch("https://chatgpt.com/backend-api/memories", {
        credentials: "include",
        headers: {"Authorization": "Bearer " + token}
      });

      if (resp.status !== 200) {
        throw new Error("Could not fetch memories (HTTP " + resp.status + ")");
      }

      var data = await resp.json();
      var memories = data.memories || data.results || data;
      var md = "# ChatGPT Memory Export\n";
      md += "# Exported: " + new Date().toISOString() + "\n";
      md += "# Tool: GPT2Claude Migration Kit v2.0\n\n";

      var count = 0;
      if (Array.isArray(memories)) {
        count = memories.length;
        for (var i = 0; i < memories.length; i++) {
          var m = memories[i];
          var content = m.content || m.value || m.text || m.memory || JSON.stringify(m);
          md += (i + 1) + ". " + content + "\n";
        }
      } else {
        md += JSON.stringify(memories, null, 2);
      }

      log("Found " + count + " memories");
      downloadFile(md, "chatgpt_memories.md", "text/markdown");
      setButtonState(btn, "done", count + " memories exported");

    } catch (err) {
      log("Memory export failed: " + err.message, "error");
      setButtonState(btn, "error", err.message);
    }
  }

  // ========== EXPORT: CONVERSATIONS ==========
  async function exportConversations() {
    var btn = document.getElementById("g2c-btn-convos");
    setButtonState(btn, "running", "Getting conversation list...");

    try {
      var token = await getToken();
      var headers = {"Authorization": "Bearer " + token};
      var allConvos = [];
      var offset = 0;

      log("Fetching conversation list...");

      while (true) {
        var listResp = await fetch(
          "https://chatgpt.com/backend-api/conversations?offset=" + offset + "&limit=100&order=updated",
          {credentials: "include", headers: headers}
        );

        if (listResp.status !== 200) {
          throw new Error("Could not get conversations (HTTP " + listResp.status + ")");
        }

        var listData = await listResp.json();
        var items = listData.items || [];
        log("Batch: " + items.length + " conversations (offset " + offset + ")");

        for (var j = 0; j < items.length; j++) {
          allConvos.push(items[j]);
        }

        offset += items.length;
        if (items.length < 100) break;
        await new Promise(function(r) { setTimeout(r, 500); });
      }

      log("Total conversations: " + allConvos.length);
      setButtonState(btn, "running", "Downloading 0/" + allConvos.length + "...");

      var fullExport = {
        export_date: new Date().toISOString(),
        tool: "GPT2Claude Migration Kit v2.0",
        total_conversations: allConvos.length,
        conversations: []
      };

      var successCount = 0;
      var errorCount = 0;

      for (var i = 0; i < allConvos.length; i++) {
        var c = allConvos[i];
        var title = c.title || "Untitled";
        var pct = Math.round(((i + 1) / allConvos.length) * 100);

        setProgress(pct, (i + 1) + " / " + allConvos.length + " — " + title);
        setButtonState(btn, "running", "Downloading " + (i + 1) + "/" + allConvos.length + "...");

        try {
          var convoResp = await fetch(
            "https://chatgpt.com/backend-api/conversation/" + c.id,
            {credentials: "include", headers: headers}
          );

          if (convoResp.status === 429) {
            log("Rate limited, waiting 30s...", "error");
            setButtonState(btn, "running", "Rate limited — waiting 30s...");
            await new Promise(function(r) { setTimeout(r, 30000); });
            i--;
            continue;
          }

          if (convoResp.status !== 200) {
            log("Skipped: " + title + " (HTTP " + convoResp.status + ")", "error");
            errorCount++;
            fullExport.conversations.push({id: c.id, title: title, error: "HTTP " + convoResp.status});
            continue;
          }

          var detail = await convoResp.json();
          var messages = [];

          if (detail.mapping) {
            var nodeKeys = Object.keys(detail.mapping);
            var nodes = [];
            for (var k = 0; k < nodeKeys.length; k++) {
              nodes.push(detail.mapping[nodeKeys[k]]);
            }
            nodes.sort(function(a, b) {
              var ta = (a.message && a.message.create_time) ? a.message.create_time : 0;
              var tb = (b.message && b.message.create_time) ? b.message.create_time : 0;
              return ta - tb;
            });

            for (var n = 0; n < nodes.length; n++) {
              var node = nodes[n];
              if (node.message && node.message.content) {
                var parts = node.message.content.parts;
                var text = "";
                if (Array.isArray(parts)) {
                  var textParts = [];
                  for (var p = 0; p < parts.length; p++) {
                    if (typeof parts[p] === "string") {
                      textParts.push(parts[p]);
                    }
                  }
                  text = textParts.join("\n");
                } else {
                  text = JSON.stringify(node.message.content);
                }
                if (text.trim() !== "") {
                  var role = "unknown";
                  if (node.message.author && node.message.author.role) {
                    role = node.message.author.role;
                  }
                  var model = null;
                  if (node.message.metadata && node.message.metadata.model_slug) {
                    model = node.message.metadata.model_slug;
                  }
                  messages.push({
                    role: role,
                    content: text,
                    timestamp: node.message.create_time || null,
                    model: model
                  });
                }
              }
            }
          }

          fullExport.conversations.push({
            id: c.id,
            title: title,
            create_time: c.create_time,
            update_time: c.update_time,
            model: detail.default_model_slug || null,
            message_count: messages.length,
            messages: messages
          });

          successCount++;
          if (i % 25 === 0 && i > 0) {
            log("Progress: " + (i + 1) + "/" + allConvos.length);
          }

        } catch (err) {
          log("Error: " + title + " — " + err.message, "error");
          errorCount++;
          fullExport.conversations.push({id: c.id, title: title, error: err.message});
        }

        await new Promise(function(r) { setTimeout(r, 1000); });
      }

      var json = JSON.stringify(fullExport, null, 2);
      var sizeMB = (json.length / 1024 / 1024).toFixed(1);

      downloadFile(json, "chatgpt_all_conversations.json", "application/json");
      setProgress(100, "Complete! " + successCount + " conversations, ~" + sizeMB + " MB");
      setButtonState(btn, "done", successCount + " conversations exported");
      log("DONE! " + successCount + " conversations, " + errorCount + " errors, ~" + sizeMB + " MB", "success");

    } catch (err) {
      log("Conversation export failed: " + err.message, "error");
      setButtonState(btn, "error", err.message);
    }
  }

  // ========== EXPORT: INSTRUCTIONS ==========
  async function exportInstructions() {
    var btn = document.getElementById("g2c-btn-instructions");
    setButtonState(btn, "running", "Exporting...");

    try {
      var token = await getToken();
      var headers = {"Authorization": "Bearer " + token};

      var endpoints = [
        {name: "custom_instructions", url: "https://chatgpt.com/backend-api/user_system_messages"},
        {name: "settings", url: "https://chatgpt.com/backend-api/settings"}
      ];

      var result = {
        export_date: new Date().toISOString(),
        tool: "GPT2Claude Migration Kit v2.0",
        data: {}
      };

      for (var i = 0; i < endpoints.length; i++) {
        var ep = endpoints[i];
        log("Fetching " + ep.name + "...");
        try {
          var resp = await fetch(ep.url, {credentials: "include", headers: headers});
          if (resp.status === 200) {
            result.data[ep.name] = await resp.json();
            log("Got: " + ep.name);
          } else {
            result.data[ep.name] = {error: "HTTP " + resp.status};
            log(ep.name + ": HTTP " + resp.status, "error");
          }
        } catch (e) {
          result.data[ep.name] = {error: e.message};
          log(ep.name + " error: " + e.message, "error");
        }
      }

      downloadFile(JSON.stringify(result, null, 2), "chatgpt_instructions.json", "application/json");
      setButtonState(btn, "done", "Instructions exported");

    } catch (err) {
      log("Instructions export failed: " + err.message, "error");
      setButtonState(btn, "error", err.message);
    }
  }

  // ========== EVENT LISTENERS ==========
  document.getElementById("g2c-close").addEventListener("click", function() {
    panel.style.animation = "g2c-fadein 0.2s ease-out reverse";
    setTimeout(function() { panel.remove(); style.remove(); }, 200);
  });

  document.getElementById("g2c-btn-memory").addEventListener("click", exportMemories);
  document.getElementById("g2c-btn-convos").addEventListener("click", exportConversations);
  document.getElementById("g2c-btn-instructions").addEventListener("click", exportInstructions);

  document.getElementById("g2c-toggle-log").addEventListener("click", function() {
    var logVisible = logEl.classList.contains("visible");
    logEl.classList.toggle("visible");
    this.textContent = logVisible ? "Show log \u25BC" : "Hide log \u25B2";
  });

  log("Ready. Click a button to start exporting.");
})();

  </script>

  <script>
  // Grab the migrate.js code and build an inline bookmarklet
  (function() {
    var scriptEl = document.getElementById("migrate-script");
    var code = scriptEl.textContent.trim();
    if (code && code !== "// GPT2Claude Migration Kit v2.0
// https://github.com/Siamsnus/GPT2Claude-Migration-Kit
// Exports ChatGPT memories, conversations, and instructions
// No data leaves your browser - everything runs locally

(function() {
  // Prevent double-loading
  if (document.getElementById("gpt2claude-panel")) {
    var existing = document.getElementById("gpt2claude-panel");
    existing.style.animation = "g2c-shake 0.3s ease-in-out";
    setTimeout(function() { existing.style.animation = ""; }, 300);
    return;
  }

  // ========== STYLES ==========
  var style = document.createElement("style");
  style.textContent = "\
    @keyframes g2c-fadein { from { opacity: 0; transform: translateY(20px) scale(0.95); } to { opacity: 1; transform: translateY(0) scale(1); } }\
    @keyframes g2c-shake { 0%,100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }\
    @keyframes g2c-spin { to { transform: rotate(360deg); } }\
    @keyframes g2c-pulse { 0%,100% { opacity: 1; } 50% { opacity: 0.5; } }\
    #gpt2claude-panel { position: fixed; top: 50%; right: 24px; transform: translateY(-50%); width: 340px; background: #0a0a0b; border: 1px solid #2a2a30; border-radius: 16px; box-shadow: 0 25px 60px rgba(0,0,0,0.6), 0 0 0 1px rgba(255,255,255,0.05); z-index: 999999; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; color: #e8e8ec; animation: g2c-fadein 0.3s ease-out; }\
    #gpt2claude-panel * { box-sizing: border-box; margin: 0; padding: 0; }\
    .g2c-header { display: flex; justify-content: space-between; align-items: center; padding: 16px 20px 12px; border-bottom: 1px solid #2a2a30; }\
    .g2c-title { font-size: 14px; font-weight: 700; letter-spacing: -0.01em; }\
    .g2c-title span.gpt { color: #a0a0e0; }\
    .g2c-title span.arrow { color: #555; margin: 0 4px; }\
    .g2c-title span.claude { color: #d4a574; }\
    .g2c-version { font-size: 10px; color: #555; font-weight: 600; }\
    .g2c-close { background: none; border: none; color: #666; font-size: 18px; cursor: pointer; padding: 4px 8px; border-radius: 6px; line-height: 1; }\
    .g2c-close:hover { background: #1c1c20; color: #e8e8ec; }\
    .g2c-body { padding: 16px 20px; }\
    .g2c-btn { width: 100%; padding: 12px 16px; border: 1px solid #2a2a30; border-radius: 10px; background: #141416; color: #e8e8ec; font-size: 13px; font-weight: 600; cursor: pointer; text-align: left; margin-bottom: 8px; display: flex; align-items: center; gap: 10px; transition: all 0.15s ease; position: relative; overflow: hidden; }\
    .g2c-btn:hover { background: #1c1c20; border-color: #3a3a40; transform: translateY(-1px); }\
    .g2c-btn:active { transform: translateY(0); }\
    .g2c-btn.running { pointer-events: none; border-color: #d4a574; }\
    .g2c-btn.done { border-color: #7eb8a0; }\
    .g2c-btn.error { border-color: #e07070; }\
    .g2c-btn-icon { font-size: 18px; width: 24px; text-align: center; flex-shrink: 0; }\
    .g2c-btn-text { flex: 1; }\
    .g2c-btn-sub { font-size: 11px; color: #666; font-weight: 400; margin-top: 2px; }\
    .g2c-progress { margin-top: 6px; }\
    .g2c-progress-bar { width: 100%; height: 4px; background: #1c1c20; border-radius: 2px; overflow: hidden; }\
    .g2c-progress-fill { height: 100%; background: linear-gradient(90deg, #d4a574, #e8c49a); border-radius: 2px; transition: width 0.3s ease; width: 0%; }\
    .g2c-progress-text { font-size: 11px; color: #8e8e96; margin-top: 4px; }\
    .g2c-log { margin-top: 12px; max-height: 120px; overflow-y: auto; background: #0d0d0e; border: 1px solid #1c1c20; border-radius: 8px; padding: 8px 10px; font-family: 'SF Mono', 'Consolas', monospace; font-size: 11px; line-height: 1.5; color: #8e8e96; display: none; }\
    .g2c-log.visible { display: block; }\
    .g2c-log-entry { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }\
    .g2c-log-entry.error { color: #e07070; }\
    .g2c-log-entry.success { color: #7eb8a0; }\
    .g2c-footer { padding: 12px 20px; border-top: 1px solid #1c1c20; display: flex; justify-content: space-between; align-items: center; }\
    .g2c-footer-text { font-size: 10px; color: #444; }\
    .g2c-footer-link { font-size: 10px; color: #d4a574; text-decoration: none; }\
    .g2c-footer-link:hover { text-decoration: underline; }\
    .g2c-spinner { display: inline-block; width: 14px; height: 14px; border: 2px solid #333; border-top-color: #d4a574; border-radius: 50%; animation: g2c-spin 0.6s linear infinite; }\
    .g2c-toggle-log { background: none; border: none; color: #555; font-size: 11px; cursor: pointer; padding: 4px 0; margin-top: 8px; }\
    .g2c-toggle-log:hover { color: #999; }\
    .g2c-drag-handle { cursor: move; }\
  ";
  document.head.appendChild(style);

  // ========== PANEL HTML ==========
  var panel = document.createElement("div");
  panel.id = "gpt2claude-panel";
  panel.innerHTML = '\
    <div class="g2c-header g2c-drag-handle">\
      <div>\
        <div class="g2c-title"><span class="gpt">GPT</span><span class="arrow">\u2192</span><span class="claude">Claude</span></div>\
        <div class="g2c-version">Migration Kit v2.0</div>\
      </div>\
      <button class="g2c-close" id="g2c-close">\u00D7</button>\
    </div>\
    <div class="g2c-body">\
      <button class="g2c-btn" id="g2c-btn-memory">\
        <div class="g2c-btn-icon">\uD83E\uDDE0</div>\
        <div class="g2c-btn-text">\
          Export Memories\
          <div class="g2c-btn-sub">Facts ChatGPT learned about you</div>\
        </div>\
      </button>\
      <button class="g2c-btn" id="g2c-btn-convos">\
        <div class="g2c-btn-icon">\uD83D\uDCAC</div>\
        <div class="g2c-btn-text">\
          Export All Conversations\
          <div class="g2c-btn-sub">Every chat with full history</div>\
        </div>\
      </button>\
      <button class="g2c-btn" id="g2c-btn-instructions">\
        <div class="g2c-btn-icon">\u2699\uFE0F</div>\
        <div class="g2c-btn-text">\
          Export Instructions\
          <div class="g2c-btn-sub">Custom instructions &amp; settings</div>\
        </div>\
      </button>\
      <div class="g2c-progress" id="g2c-progress" style="display:none;">\
        <div class="g2c-progress-bar"><div class="g2c-progress-fill" id="g2c-progress-fill"></div></div>\
        <div class="g2c-progress-text" id="g2c-progress-text"></div>\
      </div>\
      <button class="g2c-toggle-log" id="g2c-toggle-log">Show log \u25BC</button>\
      <div class="g2c-log" id="g2c-log"></div>\
    </div>\
    <div class="g2c-footer">\
      <span class="g2c-footer-text">All data stays in your browser</span>\
      <a class="g2c-footer-link" href="https://github.com/Siamsnus/GPT2Claude-Migration-Kit" target="_blank">GitHub</a>\
    </div>\
  ';
  document.body.appendChild(panel);

  // ========== DRAGGING ==========
  var isDragging = false;
  var dragOffsetX = 0;
  var dragOffsetY = 0;
  var header = panel.querySelector(".g2c-drag-handle");

  header.addEventListener("mousedown", function(e) {
    if (e.target.classList.contains("g2c-close")) return;
    isDragging = true;
    var rect = panel.getBoundingClientRect();
    dragOffsetX = e.clientX - rect.left;
    dragOffsetY = e.clientY - rect.top;
    panel.style.transition = "none";
    e.preventDefault();
  });

  document.addEventListener("mousemove", function(e) {
    if (!isDragging) return;
    panel.style.right = "auto";
    panel.style.transform = "none";
    panel.style.left = (e.clientX - dragOffsetX) + "px";
    panel.style.top = (e.clientY - dragOffsetY) + "px";
  });

  document.addEventListener("mouseup", function() {
    isDragging = false;
    panel.style.transition = "";
  });

  // ========== HELPERS ==========
  var logEl = document.getElementById("g2c-log");
  var progressEl = document.getElementById("g2c-progress");
  var progressFill = document.getElementById("g2c-progress-fill");
  var progressText = document.getElementById("g2c-progress-text");

  function log(msg, type) {
    var entry = document.createElement("div");
    entry.className = "g2c-log-entry" + (type ? " " + type : "");
    entry.textContent = msg;
    logEl.appendChild(entry);
    logEl.scrollTop = logEl.scrollHeight;
  }

  function setProgress(pct, text) {
    progressEl.style.display = "block";
    progressFill.style.width = pct + "%";
    if (text) progressText.textContent = text;
  }

  function setButtonState(btn, state, label) {
    btn.className = "g2c-btn " + state;
    var iconEl = btn.querySelector(".g2c-btn-icon");
    if (state === "running") {
      iconEl.innerHTML = '<div class="g2c-spinner"></div>';
    } else if (state === "done") {
      iconEl.textContent = "\u2705";
    } else if (state === "error") {
      iconEl.textContent = "\u274C";
    }
    if (label) {
      btn.querySelector(".g2c-btn-sub").textContent = label;
    }
  }

  function downloadFile(content, filename, type) {
    var blob = new Blob([content], {type: type || "text/plain"});
    var url = URL.createObjectURL(blob);
    var a = document.createElement("a");
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
    log("Downloaded: " + filename, "success");
  }

  var cachedToken = null;

  async function getToken() {
    if (cachedToken) return cachedToken;
    log("Authenticating...");
    var resp = await fetch("https://chatgpt.com/api/auth/session", {credentials: "include"});
    if (resp.status !== 200) {
      throw new Error("Auth failed (HTTP " + resp.status + "). Are you logged in?");
    }
    var data = await resp.json();
    if (!data.accessToken) {
      throw new Error("No token found. Please refresh chatgpt.com and try again.");
    }
    cachedToken = data.accessToken;
    log("Authenticated OK");
    return cachedToken;
  }

  // ========== EXPORT: MEMORIES ==========
  async function exportMemories() {
    var btn = document.getElementById("g2c-btn-memory");
    setButtonState(btn, "running", "Exporting...");

    try {
      var token = await getToken();

      log("Fetching memories...");
      var resp = await fetch("https://chatgpt.com/backend-api/memories", {
        credentials: "include",
        headers: {"Authorization": "Bearer " + token}
      });

      if (resp.status !== 200) {
        throw new Error("Could not fetch memories (HTTP " + resp.status + ")");
      }

      var data = await resp.json();
      var memories = data.memories || data.results || data;
      var md = "# ChatGPT Memory Export\n";
      md += "# Exported: " + new Date().toISOString() + "\n";
      md += "# Tool: GPT2Claude Migration Kit v2.0\n\n";

      var count = 0;
      if (Array.isArray(memories)) {
        count = memories.length;
        for (var i = 0; i < memories.length; i++) {
          var m = memories[i];
          var content = m.content || m.value || m.text || m.memory || JSON.stringify(m);
          md += (i + 1) + ". " + content + "\n";
        }
      } else {
        md += JSON.stringify(memories, null, 2);
      }

      log("Found " + count + " memories");
      downloadFile(md, "chatgpt_memories.md", "text/markdown");
      setButtonState(btn, "done", count + " memories exported");

    } catch (err) {
      log("Memory export failed: " + err.message, "error");
      setButtonState(btn, "error", err.message);
    }
  }

  // ========== EXPORT: CONVERSATIONS ==========
  async function exportConversations() {
    var btn = document.getElementById("g2c-btn-convos");
    setButtonState(btn, "running", "Getting conversation list...");

    try {
      var token = await getToken();
      var headers = {"Authorization": "Bearer " + token};
      var allConvos = [];
      var offset = 0;

      log("Fetching conversation list...");

      while (true) {
        var listResp = await fetch(
          "https://chatgpt.com/backend-api/conversations?offset=" + offset + "&limit=100&order=updated",
          {credentials: "include", headers: headers}
        );

        if (listResp.status !== 200) {
          throw new Error("Could not get conversations (HTTP " + listResp.status + ")");
        }

        var listData = await listResp.json();
        var items = listData.items || [];
        log("Batch: " + items.length + " conversations (offset " + offset + ")");

        for (var j = 0; j < items.length; j++) {
          allConvos.push(items[j]);
        }

        offset += items.length;
        if (items.length < 100) break;
        await new Promise(function(r) { setTimeout(r, 500); });
      }

      log("Total conversations: " + allConvos.length);
      setButtonState(btn, "running", "Downloading 0/" + allConvos.length + "...");

      var fullExport = {
        export_date: new Date().toISOString(),
        tool: "GPT2Claude Migration Kit v2.0",
        total_conversations: allConvos.length,
        conversations: []
      };

      var successCount = 0;
      var errorCount = 0;

      for (var i = 0; i < allConvos.length; i++) {
        var c = allConvos[i];
        var title = c.title || "Untitled";
        var pct = Math.round(((i + 1) / allConvos.length) * 100);

        setProgress(pct, (i + 1) + " / " + allConvos.length + " — " + title);
        setButtonState(btn, "running", "Downloading " + (i + 1) + "/" + allConvos.length + "...");

        try {
          var convoResp = await fetch(
            "https://chatgpt.com/backend-api/conversation/" + c.id,
            {credentials: "include", headers: headers}
          );

          if (convoResp.status === 429) {
            log("Rate limited, waiting 30s...", "error");
            setButtonState(btn, "running", "Rate limited — waiting 30s...");
            await new Promise(function(r) { setTimeout(r, 30000); });
            i--;
            continue;
          }

          if (convoResp.status !== 200) {
            log("Skipped: " + title + " (HTTP " + convoResp.status + ")", "error");
            errorCount++;
            fullExport.conversations.push({id: c.id, title: title, error: "HTTP " + convoResp.status});
            continue;
          }

          var detail = await convoResp.json();
          var messages = [];

          if (detail.mapping) {
            var nodeKeys = Object.keys(detail.mapping);
            var nodes = [];
            for (var k = 0; k < nodeKeys.length; k++) {
              nodes.push(detail.mapping[nodeKeys[k]]);
            }
            nodes.sort(function(a, b) {
              var ta = (a.message && a.message.create_time) ? a.message.create_time : 0;
              var tb = (b.message && b.message.create_time) ? b.message.create_time : 0;
              return ta - tb;
            });

            for (var n = 0; n < nodes.length; n++) {
              var node = nodes[n];
              if (node.message && node.message.content) {
                var parts = node.message.content.parts;
                var text = "";
                if (Array.isArray(parts)) {
                  var textParts = [];
                  for (var p = 0; p < parts.length; p++) {
                    if (typeof parts[p] === "string") {
                      textParts.push(parts[p]);
                    }
                  }
                  text = textParts.join("\n");
                } else {
                  text = JSON.stringify(node.message.content);
                }
                if (text.trim() !== "") {
                  var role = "unknown";
                  if (node.message.author && node.message.author.role) {
                    role = node.message.author.role;
                  }
                  var model = null;
                  if (node.message.metadata && node.message.metadata.model_slug) {
                    model = node.message.metadata.model_slug;
                  }
                  messages.push({
                    role: role,
                    content: text,
                    timestamp: node.message.create_time || null,
                    model: model
                  });
                }
              }
            }
          }

          fullExport.conversations.push({
            id: c.id,
            title: title,
            create_time: c.create_time,
            update_time: c.update_time,
            model: detail.default_model_slug || null,
            message_count: messages.length,
            messages: messages
          });

          successCount++;
          if (i % 25 === 0 && i > 0) {
            log("Progress: " + (i + 1) + "/" + allConvos.length);
          }

        } catch (err) {
          log("Error: " + title + " — " + err.message, "error");
          errorCount++;
          fullExport.conversations.push({id: c.id, title: title, error: err.message});
        }

        await new Promise(function(r) { setTimeout(r, 1000); });
      }

      var json = JSON.stringify(fullExport, null, 2);
      var sizeMB = (json.length / 1024 / 1024).toFixed(1);

      downloadFile(json, "chatgpt_all_conversations.json", "application/json");
      setProgress(100, "Complete! " + successCount + " conversations, ~" + sizeMB + " MB");
      setButtonState(btn, "done", successCount + " conversations exported");
      log("DONE! " + successCount + " conversations, " + errorCount + " errors, ~" + sizeMB + " MB", "success");

    } catch (err) {
      log("Conversation export failed: " + err.message, "error");
      setButtonState(btn, "error", err.message);
    }
  }

  // ========== EXPORT: INSTRUCTIONS ==========
  async function exportInstructions() {
    var btn = document.getElementById("g2c-btn-instructions");
    setButtonState(btn, "running", "Exporting...");

    try {
      var token = await getToken();
      var headers = {"Authorization": "Bearer " + token};

      var endpoints = [
        {name: "custom_instructions", url: "https://chatgpt.com/backend-api/user_system_messages"},
        {name: "settings", url: "https://chatgpt.com/backend-api/settings"}
      ];

      var result = {
        export_date: new Date().toISOString(),
        tool: "GPT2Claude Migration Kit v2.0",
        data: {}
      };

      for (var i = 0; i < endpoints.length; i++) {
        var ep = endpoints[i];
        log("Fetching " + ep.name + "...");
        try {
          var resp = await fetch(ep.url, {credentials: "include", headers: headers});
          if (resp.status === 200) {
            result.data[ep.name] = await resp.json();
            log("Got: " + ep.name);
          } else {
            result.data[ep.name] = {error: "HTTP " + resp.status};
            log(ep.name + ": HTTP " + resp.status, "error");
          }
        } catch (e) {
          result.data[ep.name] = {error: e.message};
          log(ep.name + " error: " + e.message, "error");
        }
      }

      downloadFile(JSON.stringify(result, null, 2), "chatgpt_instructions.json", "application/json");
      setButtonState(btn, "done", "Instructions exported");

    } catch (err) {
      log("Instructions export failed: " + err.message, "error");
      setButtonState(btn, "error", err.message);
    }
  }

  // ========== EVENT LISTENERS ==========
  document.getElementById("g2c-close").addEventListener("click", function() {
    panel.style.animation = "g2c-fadein 0.2s ease-out reverse";
    setTimeout(function() { panel.remove(); style.remove(); }, 200);
  });

  document.getElementById("g2c-btn-memory").addEventListener("click", exportMemories);
  document.getElementById("g2c-btn-convos").addEventListener("click", exportConversations);
  document.getElementById("g2c-btn-instructions").addEventListener("click", exportInstructions);

  document.getElementById("g2c-toggle-log").addEventListener("click", function() {
    var logVisible = logEl.classList.contains("visible");
    logEl.classList.toggle("visible");
    this.textContent = logVisible ? "Show log \u25BC" : "Hide log \u25B2";
  });

  log("Ready. Click a button to start exporting.");
})();
") {
      var href = "javascript:" + encodeURIComponent(code + "\nvoid(0);");
      document.getElementById("bookmarklet-btn").href = href;
    }
  })();
  </script>

  <!-- STEPS -->
  <div class="steps">
    <h2>How to use</h2>
    <div class="step-list">
      <div class="step-item">
        <div class="step-num s1">1</div>
        <div class="step-text">
          <h3>Go to chatgpt.com and log in</h3>
          <p>Make sure you can see your conversations in the sidebar. Any plan works &mdash; Free, Plus, Team.</p>
        </div>
      </div>
      <div class="step-item">
        <div class="step-num s2">2</div>
        <div class="step-text">
          <h3>Click the bookmark</h3>
          <p>A dark floating panel appears on the right side of the page with three export buttons.</p>
        </div>
      </div>
      <div class="step-item">
        <div class="step-num s3">3</div>
        <div class="step-text">
          <h3>Click export, files download</h3>
          <p>Each button exports one thing. Files save to your Downloads folder automatically. Upload them to Claude when done.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- WHAT YOU GET -->
  <div class="exports-section">
    <h2>What you get</h2>
    <div class="export-grid">
      <div class="export-card">
        <div class="icon">&#x1F9E0;</div>
        <h3>Memories</h3>
        <p>Every fact ChatGPT memorized about you &mdash; preferences, name, context, all of it.</p>
        <span class="filename">chatgpt_memories.md</span>
      </div>
      <div class="export-card">
        <div class="icon">&#x1F4AC;</div>
        <h3>Conversations</h3>
        <p>Every chat, every message, with timestamps and model info. The full history.</p>
        <span class="filename">chatgpt_all_conversations.json</span>
      </div>
      <div class="export-card">
        <div class="icon">&#x2699;&#xFE0F;</div>
        <h3>Instructions</h3>
        <p>Your custom instructions and settings &mdash; the personality you configured.</p>
        <span class="filename">chatgpt_instructions.json</span>
      </div>
    </div>
  </div>

  <!-- CONSOLE FALLBACK -->
  <div class="fallback">
    <div class="fallback-box">
      <h3>Bookmarklet not working?</h3>
      <p>Some browsers block bookmarklets. You can paste the script directly into the browser console instead:</p>
      <p>1. Go to <strong>chatgpt.com</strong> and log in</p>
      <p>2. Press <strong>F12</strong> &rarr; click <strong>Console</strong> tab</p>
      <p style="margin-bottom: 0.75rem;">3. Click the button below to copy the full script, then paste (Ctrl+V) into the console and press Enter:</p>
      <button id="copy-full-script" style="
        display: inline-flex; align-items: center; gap: 8px;
        padding: 10px 20px; background: var(--accent); color: var(--bg);
        border: none; border-radius: 8px; font-family: var(--sans);
        font-size: 0.85rem; font-weight: 600; cursor: pointer;
        transition: all 0.2s;
      ">&#x1F4CB; Copy full script to clipboard</button>
      <p id="copy-confirm" style="font-size: 0.8rem; color: var(--green); margin-top: 0.5rem; display: none;">Copied! Now paste into the console and press Enter.</p>
    </div>
  </div>

  <!-- IMPORTING TO CLAUDE -->
  <div class="exports-section" id="importing">
    <h2>Importing to Claude</h2>

    <div class="step-list">
      <div class="step-item">
        <div class="step-num s1">1</div>
        <div class="step-text">
          <h3>Upload your memory file first</h3>
          <p>Upload <strong>chatgpt_memories.md</strong> to Claude and use this prompt:</p>
          <p style="color:var(--accent); margin-top:0.5rem; font-style:italic;">"I just migrated from ChatGPT. This file contains all the facts and memories ChatGPT had stored about me. Please read through every item carefully and remember all of these facts about me. Confirm what you've learned and note if anything seems contradictory or outdated."</p>
        </div>
      </div>
      <div class="step-item">
        <div class="step-num s2">2</div>
        <div class="step-text">
          <h3>Upload your conversations</h3>
          <p>Upload <strong>chatgpt_all_conversations.json</strong> (zip it first if it's large) and use this prompt:</p>
          <p style="color:var(--accent); margin-top:0.5rem; font-style:italic;">"This is my complete ChatGPT conversation history. Please analyze it and create a structured summary: (1) Key ongoing projects or topics I frequently discussed, (2) Important decisions or conclusions we reached, (3) Any personal context like my profession, interests, communication style, and preferences, (4) Anything time-sensitive or unfinished that I should pick up."</p>
        </div>
      </div>
      <div class="step-item">
        <div class="step-num s3">3</div>
        <div class="step-text">
          <h3>Upload your instructions</h3>
          <p>Upload <strong>chatgpt_instructions.json</strong> and use this prompt:</p>
          <p style="color:var(--accent); margin-top:0.5rem; font-style:italic;">"These are my custom instructions and settings from ChatGPT. Please review them and adapt your communication style to match my preferences. Let me know what you've noted about how I like to interact."</p>
        </div>
      </div>
    </div>
  </div>

  <!-- WHAT TO EXPECT -->
  <div class="exports-section" id="expectations">
    <h2>What to expect after migrating</h2>

    <div class="fallback-box" style="margin-bottom:1rem;">
      <h3>Claude remembers the facts, but needs time to know <em>you</em></h3>
      <p>Think of it like switching doctors. The new doctor has your complete medical file &mdash; every test, every diagnosis, every note. But they don't <em>know</em> you yet. They don't know you downplay pain, or that "I'm fine" means you're not. That takes a few visits.</p>
      <p>Claude gets roughly <strong>70% of what ChatGPT knew</strong> from the import &mdash; all the facts, topics, and history. The remaining 30% is personal calibration: your communication style, when you want detail vs. brevity, your sense of humor, what matters most to you. That builds naturally over a couple of weeks of real conversations.</p>
      <p style="margin-bottom:0;"><strong>The good news:</strong> if you've changed since you started using ChatGPT, Claude calibrates to who you are <em>now</em>, not who you were two years ago. A fresh calibration can actually be better than inherited habits.</p>
    </div>

    <div class="fallback-box" style="margin-bottom:1rem;">
      <h3>Example: what conversations look like after import</h3>
      <p style="margin-bottom:0.5rem; color:var(--text);"><strong>You:</strong> "Do you remember that sourdough recipe we worked on?"</p>
      <p style="margin-bottom:0.75rem; color:var(--accent);"><strong>Claude:</strong> "Yes — the one with 78% hydration and the overnight cold proof. You said the crust was perfect but the crumb was too dense. We were going to try autolyse next. Want to tweak it?"</p>
      <p style="margin-bottom:0.5rem; color:var(--text);"><strong>You:</strong> "What was that movie you recommended?"</p>
      <p style="margin-bottom:0.75rem; color:var(--accent);"><strong>Claude:</strong> "You asked for sci-fi that doesn't treat the audience like idiots. I suggested Arrival, Primer, and Coherence. You watched Primer and said it melted your brain. Still haven't tried the other two."</p>
      <p style="margin-bottom:0;">Claude has access to everything you imported. Ask it about any topic from your ChatGPT history and it can find it — either from stored memory or by searching your past conversations.</p>
    </div>

    <div class="fallback-box">
      <h3>Pro tip: don't import everything if you don't need to</h3>
      <p style="margin-bottom:0;">If you used ChatGPT mostly for casual chats and only need to migrate work-related context, just upload the memories file. That gives Claude the core facts without thousands of irrelevant conversations. You can always upload conversations later if needed. Quality beats quantity &mdash; a focused memory is more useful than a cluttered one.</p>
    </div>
  </div>

  <!-- FAQ -->
  <div class="faq">
    <h2>Common questions</h2>

    <div class="faq-item">
      <h3>Is this safe? Where does my data go?</h3>
      <p>Nowhere. Everything runs in your browser. The script reads your ChatGPT data through your existing login session and saves files directly to your computer. No external servers are contacted. The source code is fully open on GitHub.</p>
    </div>

    <div class="faq-item">
      <h3>How long does the conversation export take?</h3>
      <p>About 1 second per conversation. If you have 500 chats, expect ~10 minutes. The panel shows a progress bar. Don't close the tab while it's running.</p>
    </div>

    <div class="faq-item">
      <h3>Does this work with a free ChatGPT account?</h3>
      <p>Yes. Any ChatGPT account works &mdash; Free, Plus, Team, Enterprise.</p>
    </div>

    <div class="faq-item">
      <h3>What do I do with the files once exported?</h3>
      <p>Go to <a href="https://claude.ai" style="color:var(--accent)">claude.ai</a> and upload the files. You can also use the <strong>Claude desktop app</strong> &mdash; click the <strong>+</strong> button at the bottom left, then <strong>Add files or photos</strong> (Ctrl+U). See the <strong>"Importing to Claude"</strong> section below for detailed prompts and what to expect.</p>
    </div>

    <div class="faq-item">
      <h3>The file is too large to upload</h3>
      <p>If you have hundreds or thousands of conversations, the JSON file can be huge (100MB+). Zip it first &mdash; Claude accepts .zip uploads. Right-click the file &rarr; <strong>Send to &rarr; Compressed (zipped) folder</strong> on Windows, or <strong>Compress</strong> on Mac.</p>
    </div>

    <div class="faq-item">
      <h3>The export stopped or I got an error</h3>
      <p>Usually a temporary rate limit from OpenAI. Wait a minute, refresh chatgpt.com, click the bookmark again, and retry. The tool handles rate limits automatically but occasionally needs a fresh start.</p>
    </div>

    <div class="faq-item">
      <h3>Will OpenAI ban my account for this?</h3>
      <p>This tool uses the same API that the ChatGPT website itself uses. You're accessing your own data through your own login. That said, these are undocumented endpoints and could change at any time.</p>
    </div>

    <div class="faq-item">
      <h3>No existing extension does this?</h3>
      <p>Browser extensions can export conversations as formatted text. This tool exports the raw data including memory items, message metadata, model info, and custom instructions &mdash; everything you need for a real migration, not just a printout.</p>
    </div>
  </div>

  <!-- FOOTER -->
  <div class="footer">
    <p>GPT&rarr;Claude Migration Kit &mdash; built with <a href="https://claude.ai">Claude</a> by <a href="https://www.siamsnus.com">Siamsnus</a></p>
    <p>Open source under MIT License &mdash; <a href="https://github.com/Siamsnus/GPT2Claude-Migration-Kit">View source on GitHub</a></p>
    <p style="margin-top: 0.75rem; font-size: 0.72rem; color: #444;">OpenAI's internal API endpoints may change without notice. This tool is not affiliated with OpenAI or Anthropic.</p>
  </div>

</div>

<script>
function copyFallback(el) {
  navigator.clipboard.writeText(el.textContent).then(function() {
    el.classList.add("copied");
    setTimeout(function() { el.classList.remove("copied"); }, 2000);
  });
}

// Wire up "Copy full script" button
var copyBtn = document.getElementById("copy-full-script");
if (copyBtn) {
  copyBtn.addEventListener("click", function() {
    var code = document.getElementById("migrate-script").textContent.trim();
    navigator.clipboard.writeText(code).then(function() {
      document.getElementById("copy-confirm").style.display = "block";
      copyBtn.innerHTML = "&#x2705; Copied!";
      setTimeout(function() {
        copyBtn.innerHTML = "&#x1F4CB; Copy full script to clipboard";
        document.getElementById("copy-confirm").style.display = "none";
      }, 4000);
    });
  });
}
</script>
</body>
</html>
